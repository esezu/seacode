
; 安全配置文件
; 用于配置网站的安全设置

[security]
; 基础安全设置
enable_security = TRUE
block_bots = TRUE
log_requests = TRUE
max_requests_per_minute = 100
ban_attempts = 10
ban_time_minutes = 30

; 黑名单
; 可以在这里添加要阻止的IP地址、User-Agent关键词等
[blacklist]
; IP黑名单（每行一个IP）
ip[] = "192.168.1.100"
ip[] = "10.0.0.50"

; User-Agent黑名单（关键词）
user_agents[] = "badbot"
user_agents[] = "scrapy"
user_agents[] = "curl"
user_agents[] = "wget"

; 目录黑名单（相对路径）
directories[] = "config"
directories[] = "tmp"
directories[] = "logs"

; 允许的域名（白名单）
domains[] = "localhost"
domains[] = "127.0.0.1"

[firewall]
; 防火墙规则
enable_sql_injection_check = TRUE
enable_xss_check = TRUE
enable_file_inclusion_check = TRUE
enable_remote_code_check = TRUE

timeout_seconds = 30
default_ban_time = 1800 ; 30分钟

[rate_limiting]
; API速率限制
api_max_requests = 50
api_window_minutes = 1
admin_max_requests = 20
admin_window_minutes = 1

; 搜索限制
search_max_requests = 10
search_window_minutes = 1

[privacy]
; 隐私保护设置
hide_server_info = TRUE
disable_directory_listing = TRUE
enable_https_only = FALSE ; 如果启用了SSL则设置为TRUE

[csp]
; 内容安全策略（可选）
enable_csp = FALSE
csp_header[default-src] = "'self'"
csp_header[script-src] = "'self' 'unsafe-inline' cdn.staticfile.org"
csp_header[style-src] = "'self' 'unsafe-inline' cdn.staticfile.org"
csp_header[img-src] = "'self' data: https:"
csp_header[frame-src] = "'self'"